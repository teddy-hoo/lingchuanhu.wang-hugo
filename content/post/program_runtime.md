---
title: "程序运行时内存分布"
date: 2018-04-02T21:55:05+08:00
draft: false
tags: ["基础知识"]
categories: ["操作系统"]
---

# 程序运行时内存分布

## 内存地址从低到高分布

### 1. 程序代码和数据
程序代码和全局变量想对应的位置

### 2. 堆
运行时堆，malloc和free这样的函数来处理，可动态扩展和收缩

### 3. 共享库
存放C标准库和数学库的代码和数据

### 4. 栈
用户栈，用来存放函数调用信息

### 5. 内和虚拟存储器


如下图：

```

              -----------------------
对每个进程      | 与进程相关的数据结构   | 
都不相同       | 页表，task 和 mm 结构|
              | 内核栈               |
              -----------------------
              |   物理存储器          |
              ----------------------
              |    内核虚拟存储器     |   对用户不可见的存储器
              ----------------------
              |       用户栈         |
              ----------------------    %esp  栈指针  向低地址生长
              |                     |
              ----------------------
              |  共享库的映射区       |
              ----------------------
              |                     |
              ----------------------
              |   运行时堆           |
              | 由malloc创建         |
              ----------------------
              |读，写段              |
              | 已经初始化的全局变量   |
              ----------------------     从可执行文件中加载而来
              |   只读段             |
              |  .init  程序入口     |
              | .text 机器代码       |
0x08048000    -----------------------
              | 未使用               |
           0  -----------------------

```